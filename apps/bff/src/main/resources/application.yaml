spring:
  application:
    name: dripswap-bff

  datasource:
    url: ${BFF_DB_URL:jdbc:postgresql://localhost:5432/dripswap}
    username: ${BFF_DB_USER:dripswap}
    password: ${BFF_DB_PASSWORD:dripswap}
    driver-class-name: org.postgresql.Driver

  # Graph-node 只读数据源（需在代码中手动配置 DataSource，不走 JPA/Liquibase）
  datasource-graph:
    url: ${GRAPH_DB_URL:jdbc:postgresql://localhost:5432/graph_node}
    username: ${GRAPH_DB_USER:graph}
    password: ${GRAPH_DB_PASSWORD:graph}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

  liquibase:
    enabled: true
    change-log: classpath:db/changelog/db.changelog-master.xml

  redis:
    host: ${BFF_REDIS_HOST:localhost}
    port: ${BFF_REDIS_PORT:6379}

  graphql:
    graphiql:
      enabled: true
      path: /graphiql
    schema:
      locations: classpath:graphql/**/
    path: /graphql
  mvc:
    cors:
      mappings:
        - path-pattern: "/**"
          allowed-origins: "${BFF_CORS_ALLOWED_ORIGINS:http://localhost:5173}"
          allowed-methods: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
          allowed-headers: "*"
          allow-credentials: true

server:
  port: ${BFF_SERVER_PORT:8080}

subgraph:
  batch-size: ${SUBGRAPH_BATCH_SIZE:500}
  retry-count: ${SUBGRAPH_RETRY_COUNT:3}
  chains:
    - id: sepolia
      chain-id: 11155111
      enabled: true
      endpoint: "https://api.studio.thegraph.com/query/1718761/dripswap-v-2-sepolia/version/latest"
      endpoint-v2-tokens: "https://api.studio.thegraph.com/query/1718761/dripswap-v-2-tokens-sepolia/version/latest"
      start-block: 9573280
    - id: scroll-sepolia
      chain-id: 534351
      enabled: true
      endpoint: "https://api.studio.thegraph.com/query/1716244/dripswap_v2_scroll_sepolia/version/latest"
      endpoint-v2-tokens: "https://api.studio.thegraph.com/query/1716244/drip-swap-v-2-tokens-scroll-sepolia/version/latest"
      start-block: 0

# DripSwap multi-chain configuration
dripswap:
  chains:
    - id: sepolia
      name: Ethereum Sepolia
      chainId: 11155111
      enabled: false
      rpc:
        http: "${BFF_SEPOLIA_RPC_HTTP:https://sepolia.example-rpc.io}"
        ws: "${BFF_SEPOLIA_RPC_WS:wss://eth-sepolia.g.alchemy.com/v2/DhJ0V7QwXBRjUtK5_kL8nbauZLdn5WRI}"
    - id: scroll-sepolia
      name: Scroll Sepolia
      chainId: 534351
      enabled: false
      rpc:
        http: "${BFF_SCROLL_SEPOLIA_RPC_HTTP:https://scroll-sepolia.example-rpc.io}"
        ws: "${BFF_SCROLL_SEPOLIA_RPC_WS:wss://scroll-sepolia.g.alchemy.com/v2/DhJ0V7QwXBRjUtK5_kL8nbauZLdn5WRI}"

# OpenTelemetry configuration
otel:
  exporter:
    otlp:
      endpoint: ${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4317}
  resource:
    attributes:
      service.name: dripswap-bff
      service.version: 1.0.0
